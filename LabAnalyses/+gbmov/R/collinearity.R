require(perturb)

load("~/Dropbox/Spectrum4/reducedBaselineModel_theta_21.RData")

#m = m_alt

X = model.matrix(m)
y = m@frame$`10 * log10(f_3p5_7p5)`
  
m1 = lm(y ~ X - 1)

print(colldiag(m1,add.intercept = F),fuzz=0.6)

# Condition
# Index	Variance Decomposition Proportions
# (Intercept) CONDITIONON TREMOR_DIFF_CONTRA_oamc BRADYKINESIA_DIFF_CONTRA_oamc RIGIDITY_DIFF_CONTRA_oamc AXIAL_DIFF_oamc TREMOR_OFF_CONTRA_oamc BRADYKINESIA_OFF_CONTRA_oamc RIGIDITY_OFF_CONTRA_oamc AXIAL_OFF_oamc
# 1    1.000 0.000       0.000       0.000                   0.006                         0.006                     0.005           0.000                  0.006                        0.007                    0.007         
# 2    1.236 0.000       0.000       0.004                   0.000                         0.000                     0.000           0.004                  0.000                        0.001                    0.000         
# 3    1.401 0.034       0.039       0.000                   0.001                         0.011                     0.012           0.000                  0.000                        0.013                    0.011         
# 4    1.586 0.065       0.061       0.000                   0.003                         0.017                     0.000           0.000                  0.004                        0.004                    0.001         
# 5    1.643 0.056       0.053       0.000                   0.009                         0.000                     0.008           0.000                  0.007                        0.001                    0.012         
# 6    1.713 0.001       0.001       0.000                   0.007                         0.008                     0.001           0.000                  0.009                        0.002                    0.002         
# 7    1.846 0.001       0.000       0.000                   0.001                         0.000                     0.000           0.000                  0.000                        0.006                    0.000         
# 8    2.011 0.000       0.000       0.000                   0.001                         0.003                     0.000           0.000                  0.000                        0.000                    0.001         
# 9    2.080 0.000       0.000       0.000                   0.008                         0.002                     0.000           0.000                  0.006                        0.002                    0.004         
# 10   2.159 0.000       0.001       0.000                   0.002                         0.001                     0.002           0.000                  0.000                        0.002                    0.001         
# 11   2.237 0.001       0.001       0.000                   0.001                         0.008                     0.001           0.000                  0.001                        0.035                    0.001         
# 12   2.281 0.000       0.000       0.000                   0.002                         0.001                     0.004           0.000                  0.015                        0.015                    0.036         
# 13   2.831 0.000       0.000       0.000                   0.000                         0.000                     0.000           0.000                  0.000                        0.001                    0.001         
# 14   3.023 0.004       0.011       0.005                   0.008                         0.004                     0.007           0.008                  0.002                        0.047                    0.004         
# 15   3.267 0.191       0.136       0.002                   0.015                         0.002                     0.028           0.002                  0.003                        0.098                    0.011         
# 16   3.534 0.425       0.413       0.001                   0.068                         0.025                     0.004           0.000                  0.001                        0.112                    0.012         
# 17   3.658 0.123       0.237       0.000                   0.049                         0.077                     0.003           0.000                  0.000                        0.008                    0.182         
# 18   3.942 0.030       0.027       0.000                   0.000                         0.221                     0.010           0.000                  0.150                        0.000                    0.004         
# 19   6.457 0.059       0.015       0.000                   0.116                         0.052                     0.888           0.000                  0.026                        0.107                    0.709         
# 20   7.234 0.001       0.001       0.000                   0.698                         0.558                     0.015           0.001                  0.758                        0.539                    0.001         
# 21  16.590 0.009       0.003       0.987                   0.004                         0.002                     0.011           0.984                  0.012                        0.001                    0.000         

# REMOVE TREMOR_DIFF
X = model.matrix(m2)
y = m2@frame$`10 * log10(f_61p25_91p25)`

m2 = lm(y ~ X - 1)

print(colldiag(m2,add.intercept = F))
# 
# (Intercept) CONDITIONON BRADYKINESIA_DIFF_CONTRA_oamc RIGIDITY_DIFF_CONTRA_oamc AXIAL_DIFF_oamc TREMOR_OFF_CONTRA_oamc BRADYKINESIA_OFF_CONTRA_oamc RIGIDITY_OFF_CONTRA_oamc AXIAL_OFF_oamc
# 1   1.000 0.000       0.000       0.006                         0.005                     0.005           0.000                  0.006                        0.006                    0.008         
# 2   1.324 0.000       0.001       0.001                         0.014                     0.011           0.002                  0.001                        0.013                    0.007         
# 3   1.550 0.139       0.139       0.002                         0.000                     0.002           0.000                  0.001                        0.000                    0.003         
# 4   1.591 0.017       0.018       0.009                         0.008                     0.010           0.002                  0.008                        0.001                    0.008         
# 5   1.680 0.001       0.000       0.000                         0.000                     0.002           0.009                  0.000                        0.000                    0.002         
# 6   1.778 0.001       0.000       0.001                         0.008                     0.001           0.081                  0.003                        0.001                    0.001         
# 7   1.845 0.000       0.000       0.000                         0.001                     0.001           0.171                  0.002                        0.007                    0.001         
# 8   1.958 0.001       0.000       0.000                         0.004                     0.000           0.065                  0.000                        0.000                    0.000         
# 9   2.028 0.001       0.000       0.005                         0.002                     0.000           0.209                  0.002                        0.001                    0.003         
# 10  2.073 0.000       0.000       0.001                         0.011                     0.003           0.000                  0.002                        0.010                    0.015         
# 11  2.175 0.000       0.001       0.014                         0.002                     0.001           0.000                  0.002                        0.005                    0.008         
# 12  2.203 0.002       0.000       0.001                         0.001                     0.002           0.138                  0.000                        0.007                    0.021         
# 13  2.271 0.000       0.000       0.000                         0.002                     0.000           0.001                  0.006                        0.020                    0.023         
# 14  2.392 0.000       0.002       0.004                         0.001                     0.002           0.141                  0.012                        0.007                    0.006         
# 15  2.882 0.000       0.001       0.000                         0.000                     0.001           0.070                  0.000                        0.001                    0.000         
# 16  3.205 0.001       0.000       0.006                         0.000                     0.031           0.002                  0.004                        0.101                    0.098         
# 17  3.346 0.185       0.237       0.030                         0.047                     0.003           0.057                  0.000                        0.006                    0.053         
# 18  3.618 0.611       0.574       0.033                         0.041                     0.001           0.014                  0.001                        0.018                    0.026         
# 19  3.761 0.029       0.018       0.078                         0.003                     0.011           0.005                  0.004                        0.144                    0.062         
# 20  4.097 0.000       0.000       0.004                         0.257                     0.025           0.002                  0.151                        0.003                    0.002         
# 21  5.917 0.008       0.005       0.053                         0.074                     0.887           0.008                  0.015                        0.149                    0.649         
# 22  7.424 0.002       0.001       0.752                         0.519                     0.000           0.023                  0.782                        0.501                    0.006         
# UPDRSIV_oamc poly(locAP_gmc, 2)1 poly(locAP_gmc, 2)2 poly(locML_gmc, 2)1 poly(locML_gmc, 2)2 poly(locDV_gmc, 2)1 poly(locDV_gmc, 2)2 locAP_gm_oamc locML_gm_oamc locDV_gm_oamc
# 1  0.000        0.000               0.000               0.000               0.007               0.000               0.001               0.001         0.006         0.001        
# 2  0.018        0.001               0.008               0.004               0.007               0.001               0.000               0.028         0.023         0.010        
# 3  0.004        0.001               0.003               0.000               0.000               0.001               0.003               0.003         0.000         0.000        
# 4  0.036        0.026               0.004               0.003               0.009               0.019               0.006               0.026         0.019         0.007        
# 5  0.001        0.208               0.013               0.000               0.000               0.219               0.007               0.026         0.015         0.000        
# 6  0.013        0.011               0.103               0.101               0.050               0.036               0.084               0.035         0.008         0.016        
# 7  0.021        0.002               0.092               0.124               0.000               0.003               0.203               0.000         0.021         0.001        
# 8  0.088        0.000               0.034               0.008               0.076               0.001               0.001               0.069         0.011         0.381        
# 9  0.023        0.024               0.038               0.179               0.151               0.020               0.028               0.014         0.021         0.007        
# 10 0.049        0.050               0.040               0.283               0.010               0.004               0.006               0.009         0.048         0.153        
# 11 0.216        0.004               0.236               0.018               0.006               0.001               0.282               0.007         0.011         0.043        
# 12 0.241        0.013               0.130               0.030               0.013               0.003               0.213               0.004         0.003         0.025        
# 13 0.194        0.001               0.140               0.004               0.102               0.000               0.056               0.032         0.001         0.054        
# 14 0.005        0.036               0.007               0.000               0.424               0.031               0.019               0.003         0.000         0.154        
# 15 0.000        0.598               0.003               0.223               0.014               0.650               0.006               0.007         0.004         0.006        
# 16 0.011        0.000               0.050               0.002               0.005               0.000               0.019               0.031         0.033         0.016        
# 17 0.000        0.002               0.012               0.008               0.080               0.006               0.033               0.209         0.271         0.000        
# 18 0.003        0.000               0.000               0.001               0.021               0.000               0.013               0.050         0.062         0.000        
# 19 0.013        0.006               0.026               0.006               0.017               0.002               0.000               0.378         0.324         0.028        
# 20 0.016        0.003               0.008               0.000               0.001               0.000               0.004               0.057         0.104         0.006        
# 21 0.049        0.001               0.040               0.006               0.006               0.001               0.010               0.000         0.013         0.084        
# 22 0.000        0.014               0.012               0.000               0.002               0.001               0.005               0.010         0.001         0.007        
# CONDITIONON:BRADYKINESIA_DIFF_CONTRA_oamc CONDITIONON:RIGIDITY_DIFF_CONTRA_oamc CONDITIONON:AXIAL_DIFF_oamc
# 1  0.011                                     0.006                                 0.008                      
# 2  0.002                                     0.018                                 0.017                      
# 3  0.003                                     0.002                                 0.004                      
# 4  0.016                                     0.017                                 0.025                      
# 5  0.000                                     0.000                                 0.005                      
# 6  0.000                                     0.030                                 0.001                      
# 7  0.005                                     0.014                                 0.009                      
# 8  0.001                                     0.006                                 0.000                      
# 9  0.041                                     0.001                                 0.000                      
# 10 0.010                                     0.018                                 0.015                      
# 11 0.019                                     0.012                                 0.000                      
# 12 0.055                                     0.013                                 0.001                      
# 13 0.069                                     0.034                                 0.074                      
# 14 0.058                                     0.053                                 0.011                      
# 15 0.004                                     0.011                                 0.000                      
# 16 0.001                                     0.102                                 0.542                      
# 17 0.062                                     0.022                                 0.032                      
# 18 0.093                                     0.005                                 0.013                      
# 19 0.217                                     0.083                                 0.008                      
# 20 0.244                                     0.480                                 0.035                      
# 21 0.026                                     0.010                                 0.197                      
# 22 0.061                                     0.064                                 0.001    